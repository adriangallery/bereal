async function acceptOffer(offerId, tokenId) {
  try {
    // Obtenemos los detalles de la oferta
    const offer = await offersContract.offers(offerId);
    
    // Obtenemos la allowance y el balance del comprador
    const buyerAllowance = await tokenContract.allowance(offer.buyer, offersContractAddress);
    const buyerBalance = await tokenContract.balanceOf(offer.buyer);
    console.log("Offer amount:", offer.offerAmount.toString());
    console.log("Buyer allowance:", buyerAllowance.toString());
    console.log("Buyer balance:", buyerBalance.toString());
    
    // Verificamos que la allowance sea suficiente
    if (buyerAllowance.lt(offer.offerAmount)) {
      alert("Buyer has not approved enough tokens. They must approve at least the full offer amount (" +
            ethers.utils.formatUnits(offer.offerAmount, 18) + " ADRIAN) for the contract.");
      return;
    }
    
    // Verificamos que el vendedor (usuario conectado) tenga suficiente NFT
    const sellerNFTBalance = await nftContract.balanceOf(userAccount, tokenId);
    if (sellerNFTBalance.lt(offer.quantity)) {
      alert("You do not own enough of this NFT.");
      return;
    }
    
    // Llamamos a la funci√≥n acceptOffer del contrato
    const tx = await offersContract.acceptOffer(offerId);
    await tx.wait();
    alert("Offer accepted successfully!");
    loadOffersForToken(tokenId);
    loadListingsForToken(tokenId);
  } catch (error) {
    console.error("Error accepting offer:", error);
    alert("Error accepting offer: " + error.message);
  }
}

<!-- components/menu.html -->
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <div class="container">
    <a class="navbar-brand" href="index.html">$ADRIAN</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="index.html">Inicio</a></li>
        <li class="nav-item"><a class="nav-link" href="auction.html">Adrian Auction</a></li>
        <li class="nav-item"><a class="nav-link" href="pumpit.html">Pump your ADRIANS</a></li>
        <li class="nav-item"><a class="nav-link" href="filthyrich.html">Filthy Rich</a></li>
        <li class="nav-item"><a class="nav-link" href="holdings.html">Your Holdings</a></li>
        <li class="nav-item"><a class="nav-link" href="burnstats.html">Burn Stats</a></li>
        <li class="nav-item"><a class="nav-link" href="https://twitter.com/adriancerda" target="_blank">Twitter</a></li>
        <li class="nav-item"><a class="nav-link" href="https://discord.gg/YHc5Sh65Hm" target="_blank">Discord</a></li>
        <li class="nav-item"><a class="nav-link" href="https://opensea.io/collection/adriangallery" target="_blank">OpenSea</a></li>
        <li class="nav-item"><a class="nav-link" href="https://dexscreener.com/base/0xa51d80c15b0b67b9f32865d3351977a7006c462f" target="_blank">Chart</a></li>
      </ul>
      <!-- Botón de conexión en el menú -->
      <div class="d-flex ms-3">
        <button id="menuConnectButton" class="btn btn-primary">Connect Wallet</button>
        <span id="menuWalletDisplay" class="ms-2 text-white"></span>
      </div>
    </div>
  </div>
</nav>

<!-- Script inline con nonce para gestionar la conexión sin eval -->
<script nonce="abc123">
  console.log("Menu script loaded with nonce");

  async function connectWalletFromMenu() {
    if (window.ethereum) {
      try {
        // Comprobar si ya existe conexión guardada
        let connectedAddress = localStorage.getItem("connectedAddress") || window.ethereum.selectedAddress;
        if (!connectedAddress) {
          await window.ethereum.request({ method: "eth_requestAccounts" });
          connectedAddress = window.ethereum.selectedAddress;
          localStorage.setItem("connectedAddress", connectedAddress);
        }
        document.getElementById("menuWalletDisplay").textContent = "Connected: " + connectedAddress;
        console.log("Wallet connected: " + connectedAddress);
      } catch (error) {
        console.error("Error connecting from menu:", error);
      }
    } else {
      console.error("MetaMask is not installed.");
    }
  }

  document.addEventListener("DOMContentLoaded", function() {
    const btn = document.getElementById("menuConnectButton");
    if (btn) {
      btn.addEventListener("click", connectWalletFromMenu);
    } else {
      console.error("menuConnectButton not found.");
    }
    // Si ya hay conexión, mostrarla automáticamente
    if (window.ethereum && (localStorage.getItem("connectedAddress") || window.ethereum.selectedAddress)) {
      connectWalletFromMenu();
    }
  });
</script>
